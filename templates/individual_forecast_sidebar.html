<div class="col-sm-2 peleus-sidebar">

    <div id="peleus-left-toggle-wrap">
        <div class="peleus-left-toggle collapse">
            <form id="forecast-vote-form" action="{% url 'forecast_vote' %}" method="post">
                {% csrf_token %}
                <input type="hidden" name="forecast-id" value="{{ forecast.id }}">

{#                <div class="form-group">#}
                    <span>
                        {% if last_vote == None %}Input initial prediction
                        {% else %}Adjust your prediction{% endif %}</span>
{#                    <input type="number" min="0" max="100" value="{{ last_vote|default_if_none:"" }}"#}
{#                           class="form-control"#}
{#                           placeholder="{% if last_vote == None %}Initial#}
{#                           {% else %}Adjust{% endif %} prediction" name="forecast-vote" id="forecast-vote" required>#}
                {% for field in vote_form %}
                    <div class="form-group">
                    {{ field }}
                    </div>
                {% endfor %}


{#                <script type="text/javascript">#}
{#                                   $(function () {#}
{#                        $("#slider-range").slider({#}
{#                            range: true,#}
{#                            min: 0,#}
{#                            max: 500,#}
{#                            values: [10, 100],#}
{#                            slide: function (event, ui) {#}
{#                                $("#amount").val(ui.values[0] + " - " + ui.values[1]);#}
{#                            }#}
{#                        });#}
{#                        $("#amount").val($("#slider-range").slider("values", 0) +#}
{#                        " - " + $("#slider-range").slider("values", 1));#}
{#                    });#}
{#                </script>#}
{##}
{#                <p>#}
{#                    <input type="text" id="amount" readonly style="border:0; color:#f6931f; font-weight:bold;">#}
{#                </p>#}
{##}
{#                <div id="slider-range" style="margin-bottom: 20px"></div>#}

                <div class="form-group">
                    <a class="btn btn-danger btn-sm btn-block" data-toggle="collapse"
                       data-target=".peleus-left-toggle" href="#"
                       data-parent="#peleus-left-toggle-wrap">Cancel</a>
                </div>
                <div class="form-group">

                    <a href="#" class="form-control btn btn-success" data-toggle="modal" id="vote">
                        {% if last_vote == None %}Initiate
                            forecast{% else %}Adjust prediction{% endif %}</a>
                </div>
            </form>
        </div>
        <div class="peleus-left-toggle collapse in">
            {% if last_vote != None %}<span>My Current Prediction:<br>{{ last_vote }}</span>{% endif %}
            <button class="form-control btn btn-primary" data-toggle="collapse" data-target=".peleus-left-toggle"
                    data-parent="#peleus-left-toggle-wrap">
                {% if last_vote == None %}Initiate forecast{% else %}Adjust prediction{% endif %}
            </button>
        </div>
    </div>
    <div id="modal-dialog" class="modal">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-body">
                </div>
                <div class="modal-footer">
                    <button class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button class="btn btn-primary" id="forecast-btn-submit">Confirm</button>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
            var voteInput = $('#id_vote').get(0);
            var form = $('#forecast-vote-form');
            var name = $('#forecast-question').html();

            function submitVote() {
                {% if forecast.forecast_type == FORECAST_TYPE_FINITE %}
                var vote = $(voteInput).find(':selected').text();
                {% else %}
                var vote = $(voteInput).val();
                {% endif %}
                if (voteInput.checkValidity()) {
                    $('#modal-dialog').find('.modal-body').html(
                            '<p>Please confirm you wish to initiate your forecast on <i>' + name +
                            '</i> at <i>' + vote + '</i></p>');
                    $('#modal-dialog').modal('show');

                    $('#forecast-btn-submit').click(function (e) {
                        form.submit();
                    });
                }
            }

            $('#vote').click(submitVote);
            $(voteInput).keypress(function (e) {
                if (e.keyCode === 13) {
                    submitVote();
                    return false;
                }
                return true;
            })
        })
    </script>
</div>